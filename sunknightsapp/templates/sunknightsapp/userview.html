{% extends "sunknightsapp/base.html" %}


{% block content %}
    {% load widget_tweaks %}


    <ul class="nav nav-tabs">
        <li class="nav-item active"><a href="#overview" class="nav-link" data-toggle="tab">Overview</a></li>
        <li class="nav-item"><a href="#submit-pts" class="nav-link" data-toggle="tab">Submit Score</a></li>
        <li class="nav-item"><a href="#open-submissions" class="nav-link" data-toggle="tab">Open Submission</a></li>
        <li class="nav-item"><a href="#decided-submissions" class="nav-link" data-toggle="tab">Decided Submission</a>
        </li>
    </ul>


    <div class="tab-content clearfix">
        <div class="tab-pane active" id="overview">
            {% include "sunknightsapp/snippets/useroverview.html" %}
        </div>
        <div class="tab-pane" id="submit-pts">
            {% include "sunknightsapp/snippets/pointssubmitform.html" %}
        </div>
        <div class="tab-pane" id="open-submissions">
            {% include "sunknightsapp/snippets/opensubmissions.html" %}
        </div>
        <div class="tab-pane" id="decided-submissions">
            {% include "sunknightsapp/snippets/decidedsubmissions.html" %}
        </div>

    </div>

{% endblock %}

{% block scripts %}
    var datatableopensubmissions = $('#open-submissions-table').DataTable();


    $('#recordsubmit').on('submit',function(event){
    event.preventDefault();

    //set default note if nothing was set

    var note=$('#submitterspam').val()
    if (note=="")
    $('#submitterspam').val('None')




    var form=new FormData(this);


    $('#sbmrecord').modal('hide')
    sunKnightsJsonRequest(form,function(result,data){
    if (result){
    submission=data['message']['data']
    datatableopensubmissions.row.add([
        submission['id'],
        submission['tank']['name'],
        submission['gamemode']['name'],
        submission['points'],
        "<a href=\""+submission['proof']+"\">Prooflink</a>"
    ]).draw(false)
    }
    else {
    console.log('fuck this shit')

    }
    },false,false);
    this.reset();
    });

{% endblock %}


